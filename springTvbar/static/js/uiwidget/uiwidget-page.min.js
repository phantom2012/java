/**
 * ajax 加载页面
 */
//jQuery.fn.extend({
//	load: function( url, params, callback ,ajaxOptions) {
//		if ( typeof url !== "string" ) {
//			return _load.call( this, url );
//
//		// Don't do a request if no elements are being requested
//		} else if ( !this.length ) {
//			return this;
//		}
//		var off = url.indexOf(" ");
//		if ( off >= 0 ) {
//			var selector = url.slice(off, url.length);
//			url = url.slice(0, off);
//		}
//		// Default to a GET request
//		var type = "GET";
//		// If the second parameter was provided
//		if ( params ) {
//			// If it's a function
//			if ( jQuery.isFunction( params ) ) {
//				// We assume that it's the callback
//				callback = params;
//				params = null;
//
//			// Otherwise, build a param string
//			} else if ( typeof params === "object" ) {
//				params = jQuery.param( params, jQuery.ajaxSettings.traditional );
//				type = "POST";
//			}
//		}
//		var self = this;
//		// Request the remote document
//		var newAjaxOptions = $.extend({},ajaxOptions, {
//			url: url,
//			type: type,
//			dataType: "html",
//			data: params,
//			complete: function( res, status ) {
//				// If successful, inject the HTML into all the matched elements
//				if ( status === "success" || status === "notmodified" ) {
//					if(status === "notmodified" && res.responseText==""){
//						var secAjaxOptions = $.extend({},ajaxOptions, {ifModified:false});
//						self.load(url, params, callback, secAjaxOptions);
//					}else{
//						// See if a selector was specified
//						self.html( selector ?
//							// Create a dummy div to hold the results
//							jQuery("<div />")
//								// inject the contents of the document in, removing the scripts
//								// to avoid any 'Permission Denied' errors in IE
//								.append(res.responseText.replace(rscript, ""))
//
//								// Locate the specified elements
//								.find(selector) :
//
//							// If not, just inject the full result
//							res.responseText );
//						if ( callback ) {
//							self.each( callback, [res.responseText, status, res] );
//						}
//					}
//				}
//			}
//		});
//		jQuery.ajax(newAjaxOptions);
//		return this;
//	},
//	serialize: function() {
//		return jQuery.param(this.serializeArray());
//	},
//	serializeArray: function() {
//		return this.map(function() {
//			return this.elements ? jQuery.makeArray(this.elements) : this;
//		})
//		.filter(function() {
//			return this.name && !this.disabled &&
//				(this.checked || rselectTextarea.test(this.nodeName) ||
//					rinput.test(this.type));
//		})
//		.map(function( i, elem ) {
//			var val = jQuery(this).val();
//
//			return val == null ?
//				null :
//				jQuery.isArray(val) ?
//					jQuery.map( val, function( val, i ) {
//						return { name: elem.name, value: val };
//					}) :
//					{ name: elem.name, value: val };
//		}).get();
//	}
//});

;
(function ($) {
    $.uiwidget = $.uiwidget || {};
    $.uiwidget.Page = function (el, cfg) {

        if (typeof cfg == 'string') {
            cfg = {url: cfg};
        }

        $.extend(this, cfg);
        if (!this.url) {
            return;
        }
        this.el = el;
        if (this.url.indexOf('/album/') != -1) {

            window.defaultUrl = '../album/';
        } else if (this.url.indexOf('/center/') != -1) {
            window.defaultUrl = '../center/';
        } else if (this.url.indexOf('/gh/') != -1) {
            window.defaultUrl = '../gh/';
        } else if (this.url.indexOf('/music/') != -1) {
            window.defaultUrl = '../music/';
        }
        if (window.defaultUrl)
            this.url = window.defaultUrl + this.url;
        if (!window.urlPaths) {
            window.urlPaths = [];
        }
        if (this.url.indexOf('songComment.html') == -1 && this.url.indexOf('singer_right.html') == -1)
            window.urlPaths.push(this.url);

        if (window.clip) {
            window.clip.destroy();
        }

        //	$(clip.movieId).remove();
        this.load();
    };

    $.uiwidget.Page.prototype = {
        ajaxOptions: {cache: false, ifModified: false}, load: function () {
            var t = this;
            t.el.load(t.url, t.data, function () {
//				setTimeout( function(){
//					var str = '<script type="text/javascript">_hiido_no=0;_hiido_wid=["_8285896"];</script><script type="text/javascript" src="http://www.duowan.com/duowan.js"></script>';
//					$(t.el).append(str);
//				},10)
                if (t.afterLoad)
                    t.afterLoad();
            }, t.ajaxOptions);

        }
    };
    $.fn.page = function (cfg) {
        return new $.uiwidget.Page(this, cfg);
    };
})(jQuery);	