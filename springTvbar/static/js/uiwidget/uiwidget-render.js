(function(a){a.uiwidget=a.uiwidget||{};a.uiwidget.Cherry=function(c,b){a.extend(this,b);this.target=c;this.init()};a.uiwidget.Cherry.prototype={bean:null,list:[],init:function(b){var c=this;if(!c.url){c.render(c.json)}else{a.ajax({url:c.url,type:c.type,dataType:"json",data:c.params,success:function(d){c.render(d)}})}},render:function(c){var b=this;b.json=c;var e=a(b.target);if(b.type=="bean"){b._trans(b.getBean(),b.json)}else{if(b.type=="list"){if(!b.sourceTemplet){b.dataTypes=e.find("[datatype='item']");if(b.dataTypes.length>0){b.sourceTemplet=a(b.dataTypes[0]).clone()}}var d=b.dataTypes.parent();d.empty();b.dataTypes.length=0;a(b.json).each(function(f,h){var g=b.sourceTemplet.clone();d.append(g);b.dataTypes.push(g);b._trans(b.getList(g,f)[f],b.json[f],f);if(b.each){b.each(g,f)}})}}return b},_trans:function(e,c,d){var b=this;if(!c){return}e.each(function(g,k){var j=a(k).attr("datafield");var h=null;var f=a(b.templet).attr(j);if(a.isFunction(f)){h=f(a(k),c,d)}else{h=a(c).attr(j)}if(a.isNumeric(h)){h+=""}if(a.type(h)==="string"){a(k).html(b.htmlFilter(h))}})},getBean:function(){var b=this;if(!b.bean){b.bean=b.target.find("[datafield]")}return b.bean},getList:function(d,c){var b=this;b.list[c]=a(d).find("[datafield]");return b.list},htmlFilter:function(f){if(!f){return""}var e="";var b="";for(var d=0;d<f.length;d++){var g=f.charAt(d);switch(g){case"<":b+="&lt;";break;case">":b+="&gt;";break;case"&":b+="&amp;";break;case'"':b+="&quot;";break;case"'":b+="&#39;";break;default:b+=g}}e=b.toString();return e}};a.fn.cherry=function(b){return new a.uiwidget.Cherry(this,b)}})(jQuery);