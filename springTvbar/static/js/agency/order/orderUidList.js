var com=com||{};com.yy=com.yy||{};com.yy.agency=com.yy.agency||{};com.yy.agency.OrderUidList=function(){};(function(d,c){var a={};var b;d.prototype={init:function(e){var f=this;e=e||{};f._init();f._initEditor()},_init:function(){c("[_id='close']").live("click",function(){c.uiwidget.popupHide({id:"popUpBox"})});c("#nick").html(c.cookie("nick"))},_initEditor:function(){KindEditor.ready(function(e){b=e.editor({uploadJson:"/agency/uploadArbitrationUid.action",allowFileManager:false})})},contact:function(f){var e=a[f];if(!e){c.ajaxData("/agency/queryCompanyContactInfo.action",{cid:f},{success:function(i){var h=i.data;var g=[];g.push("YY："+arrowFilter(h.yy));g.push("TEL："+arrowFilter(h.tel));g.push("EMAIL："+arrowFilter(h.email));var i=g.join("<br/>");a[f]=i;c.alert(i,"success")}})}else{c.alert(e,"success")}},queryHistory:function(e){c.ajaxData("/agency/queryOrderChangeHistory.action",{id:e},{success:function(k){var j=k.data;var h=[];for(var f=0;f<j.length;f++){var g=j[f];h.push(g.record_time+" "+g.memo)}c.alert(h.join("<br/>"),"success")}})},cancelOrder:function(e){c.messagebox({type:"ask",msg:"确定取消订单吗?",fn:function(f){if(f.index==0){c.ajaxData("/agency/cancelOrder.action",{id:e},{success:function(g){c.alert("提交成功","success",{fn:function(){location.href="/agency/queryServiceOrderList.action"}})}})}}})},confirmOrder:function(e){c.messagebox({type:"ask",msg:"确定收货吗?",fn:function(f){if(f.index==0){c.ajaxData("/agency/confirmOrder.action",{id:e},{success:function(g){c.alert("提交成功","success",{fn:function(){location.href="/agency/queryServiceOrderListByStaus.action?status=3"}})}})}}})},browseWorks:function(f){var e=this;c.ajaxData("/agency/queryUidWorks.action",{id:f},{success:function(g){e.popUpBox("browseBox",{id:f,list:g.data,order:e})}})},arbitration:function(f){var e=this;c.ajaxData("/agency/queryArbitrationUid.action",{id:f},{success:function(h){e.popUpBox("arbitrationBox",{id:f,list:h.data,order:e});var g=c("#arbitrationForm");g.data("serialize",g.serialize());c("a[_id='arbitrationComplete']").ajaxForm("arbitrationForm",{success:function(i){c.alert("提交成功","success",{fn:function(){location.href="/agency/queryServiceOrderListByStaus.action?status=4"}})},handleError:function(j,k){var i=j.attr("name");if("info_link"==i){j.closest("td").addClass("warning")}else{j.addClass("warning")}},handleOk:function(j){var i=j.attr("name");if("info_link"==i){j.closest("td").removeClass("warning")}else{j.removeClass("warning")}}});c("[_id='arbitrationClose']").click(function(){var i=c("#arbitrationForm");if(i.serialize()!=i.data("serialize")){c.messagebox({type:"ask",msg:"确定放弃编辑的内容?",fn:function(j){if(j.index==0){c.uiwidget.popupHide({id:"popUpBox"})}}})}else{c.uiwidget.popupHide({id:"popUpBox"})}})}})},newArbitrationFile:function(){var e=this.templateHtml("addArbitrationTr");c('tbody[_id="new"]').append(e)},deleteArbitrationFile:function(h,g){var f=c(h);var e=f.closest("tr");if(g){c.messagebox({type:"ask",msg:"确定删除?",fn:function(i){if(i.index==0){e.remove();c.ajaxData("/agency/deleteArbitrationUid.action",{id:g})}}})}else{e.remove()}},tab:function(e){c("[_id='tab"+e+"']").addClass("active");c("[_id='tab"+(1-e)+"']").removeClass("active");c("[_id='show"+e+"']").show();c("[_id='show"+(1-e)+"']").hide();c("[_id='add"+e+"']").show();c("[_id='add"+(1-e)+"']").hide()},uploadArbitrationFile:function(h,g){var e=c(h);var f=e.next('input[name="info_link"]');b.loadPlugin("insertfile",function(){b.plugin.fileDialog({fileUrl:f.val(),clickFn:function(i,j){f.val(i);f.blur();b.hideDialog()}})})},arbitrationResult:function(f){var e=this;c.ajaxData("/agency/queryArbitrationResultUid.action",{id:f},{success:function(g){e.popUpBox("arbitrationResultBox",{id:f,list:g.data.list,record:g.data.record,order:e});c("[_id='arbitrationConfirm']").click(function(){c.messagebox({type:"ask",msg:"确认仲裁吗?",fn:function(h){if(h.index==0){c.ajaxData("/agency/confirmArbitration.action",{id:f},{success:function(i){c.alert("提交成功","success",{fn:function(){location.href="/agency/queryServiceOrderList.action"}})}})}}})})}})},popUpBox:function(e,g){var f=this.templateHtml(e,g);c("#popUpBox").html(f);c.uiwidget.popupShow({id:"popUpBox"})},templateHtml:function(e,h){var g=h||{};g.$=c;g.window=window;g.document=document;var f=template(e,g);return f}}})(com.yy.agency.OrderUidList,jQuery);