$(document).ready(function(){function a(c,d){this.userId=uid;this.pointId=pointId;this.topicId=topicId;this.description=c;this.evidences=d}function b(d,e,c){this.creatorId=uid;this.pointId=pointId;this.topicId=topicId;this.picture=d;this.handlePic=e;this.description=c}$("#postTopic").bind("click",function(){var j=new Array();var f=document.getElementsByClassName("url");var h=document.getElementsByClassName("imgUrl");var g=document.getElementsByClassName("topic-desc-area");if(h.length!=g.length){alert("页面出错！")}else{for(var e=0;e<g.length;e++){var d=new b(f[e].innerHTML,h[e].innerHTML,g[e].value);j[e]=d}var c=new a($("#viewpointIpt")[0].value,j)}$.ajax({url:"http://tvbar.yy.com/tvbar/replyTopic.action",data:{uid:uid,point:JSON.stringify(c)},type:"post",dataType:"json",success:function(i){var k=i.data;if(k.result==1){location.href="http://tvbar.yy.com/topicPage.action?uid="+uid+"&topicId="+topicId;alert("发表成功")}else{alert("发表失败，请先登录")}},exception:function(i){alert("发表失败");if(i.result==3005){}}})})});