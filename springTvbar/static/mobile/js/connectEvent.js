(function(){var a={eventBind:function(){var d=0;var c=$("#Content");var b;$.ajax({url:"http://tvbar.yy.com/tvbar/queryEvent.action",type:"post",async:false,success:function(f){var g=JSON.parse(f).data;for(var e=0;e<g.length;e++){b+=' <option value ="'+g[e].eventId+'">'+g[e].description+"</option>"}}});$.ajax({url:"http://tvbar.yy.com/tvbar/queryTopic.action",type:"post",async:false,success:function(g){var h=JSON.parse(g).data;for(var e=0;e<h.length;e++){var f=['<div class="connectList">',' <div class="topicId" hidden="true">'+h[e].topicId+"</div>",' 话题标题： <div class="topicTitle">'+h[e].title+"</div>",' 话题描述： <div class="topicDesc">'+h[e].description+"</div>",' 对应事件：<div class="topicEvent">'+h[e].eventDesc+"</div>",' <select class="eventList" >',b," </select>",'<br/> <input type="button" class="connecting" value="关联"></input>',"<h3>---------------------------</h3>"].join("");$("#Content").append(f)}}});c.on("click",".connecting",function(){var e=$(this);var f=e.parents(".connectList");topicId=f.find(".topicId")[0].innerHTML;eventId=f.find(".eventList")[0].value;$.ajax({url:"http://tvbar.yy.com/tvbar/connectEventTopic.action",type:"post",data:{topicId:topicId,eventId:eventId},success:function(g){location.reload()}})});c.on("mouseleave","#eventList",function(){$("#eventList option").remove()})},init:function(){this.eventBind()}};$(function(){a.init()})})();