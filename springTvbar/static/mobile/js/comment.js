$(function(){var c=1;function a(h,i,f,g){$(".load").show();c++;$.ajax({type:"get",url:h+"?groupId="+i+"&&pageIndex="+f,dataType:"json",timeout:10000,success:function(j){$(".load").hide();if(j.data.topics.length>0){b(i,g,j.data.topics)}else{$(window).unbind("scroll")}},error:function(){console.log("error")}})}function b(g,n,r){var q=$(n);var p="";for(var o=0;o<r.length;o++){p+='<div class="item" _uid="'+userId+'" _topicId="'+r[o].topicId+'">';p+=' <div class="reply-topic"><span class="th">话题：</span>'+r[o].title+'<em class="triangle"></em></div>';p+=' <div class="thead"><div class="pic"><img src="'+r[o].creatorIcon+'" alt=""></div><p><span class="name">'+r[o].creatorName+'</span><span class="action">发布了话题</span></p><p class="date">'+r[o].createTime+"</p></div>";p+=' <div class="tbody"><p>'+r[o].description+"</p></div> ";p+=' <div class="tfoot"><span class="tag"></span></div>';p+="</div>";for(var m=0,h=r[o].viewPoints;m<h.length;m++){p+='<div class="item" _uid="'+userId+'" _topicId="'+r[o].topicId+'">';p+=' <div class="reply-topic"><span class="th">话题：</span>'+r[o].title+'<em class="triangle"></em></div>';p+=' <div class="thead"><div class="pic"><img src="'+h[m].creatorIcon+'" alt=""></div><p><span class="name">'+h[m].creatorName+'</span><span class="action">回复了话题</span></p><p class="date">'+r[o].createTime+"</p></div>";p+='<div class="tbody"><p><span class="icon s-viewport">观点</span>'+h[m].description+'</p><div class="pic-list"><a href="">';for(var l=0,f=h[m].evidences;l<3;l++){if(f[l]==null){break}p+='<img src="'+f[l].handlePic+'" alt="">'}p+='<span class="tip">共'+f.length+"张图</span></a></div></div>";p+=' <div class="tfoot"><span class="support-num">支持<i>'+h[m].zanCount+'</i></span><span class="tag"></span></div>';p+="</div>"}}q.append(p)}var d=$(window).height();var e=function(i,h,j,g,m){var l=$(document.body).height();var f=$(window).scrollTop();var k=(l-d-f)/d;c=j;if(l-d-f<200){a(i,h,c,g);if(typeof m==="function"){m(c)}}};window.scrollHandler=e});