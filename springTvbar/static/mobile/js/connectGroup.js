(function(){var a={eventBind:function(){var d=0;var c=$("#Content");var b;$.ajax({url:"http://tvbar.yy.com/tvbar/queryGroups.action",type:"post",async:false,success:function(f){var g=JSON.parse(f).data;for(var e=0;e<g.length;e++){b+=' <option value ="'+g[e].groupId+'">'+g[e].title+"</option>"}}});$.ajax({url:"http://tvbar.yy.com/tvbar/queryEventDetail.action",type:"post",async:false,success:function(h){var k=JSON.parse(h).data;for(var g=0;g<k.length;g++){var f='<div class="connectList"> <div class="eventId" hidden="true">'+k[g].eventId+'</div> 事件描述： <div class="EventDesc">'+k[g].description+"</div> 关联的小组：";for(var e=0;e<k[g].groups.length;e++){f+='<div class="groupList"><div class="groupId" hidden="true">'+k[g].groups[e].groupId+'</div><div class="groupTitle" >'+k[g].groups[e].title+'</div><input type="button" class="cancel" value="取消关联"></input></div>'}f+=' <br/><select class="eventList" >'+b+' </select><br/> <input type="button" class="connecting" value="关联"></input><h3>---------------------------</h3>';$("#Content").append(f)}}});c.on("click",".connecting",function(){var e=$(this);var f=e.parents(".connectList");eventId=f.find(".eventId")[0].innerHTML;groupId=f.find(".eventList")[0].value;$.ajax({url:"http://tvbar.yy.com/tvbar/connectEventGroup.action",type:"post",data:{eventId:eventId,groupId:groupId},success:function(g){location.reload()}})});c.on("click",".cancel",function(){var f=$(this);var g=f.parents(".connectList");eventId=g.find(".eventId")[0].innerHTML;var e=f.parents(".groupList");groupId=e.find(".groupId")[0].innerHTML;$.ajax({url:"http://tvbar.yy.com/tvbar/cancelEventGroup.action",type:"post",data:{eventId:eventId,groupId:groupId},success:function(h){location.reload()}})});c.on("mouseleave","#eventList",function(){$("#eventList option").remove()})},init:function(){this.eventBind()}};$(function(){a.init()})})();